<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>실제 DOM변경</title>
  </head>
  <body>
    <!-- 렌더링 엔진이 거치는 전체 프로세스
1. HTML 파싱: 브라우저는 웹 페이지의 HTML 코드를 읽어들입니다. 
    이 과정에서 각 요소의 구조를 분석하고 DOM (문서 객체 모델)을 생성합니다. 
2. CSS 파싱 및 스타일 계산: HTML 파싱 후에는 브라우저가 CSS 스타일 시트를 파싱하고 이를 적용하여 각 요소의 스타일을 계산합니다. 
       이 단계에서는 각 요소에 대한 최종적인 스타일 정보가 생성됩니다.
3. 레이아웃 (리플로우): 레이아웃은 요소의 스타일, 크기, 위치 등을 고려하여 화면에 어떻게 표시될지를 결정합니다.

4. 렌더링 트리 구축: DOM과 CSSOM(스타일 객체 모델)을 결합하여 렌더링 트리를 생성합니다. 
    렌더링 트리는 화면에 표시될 요소의 구조를 나타내는데, 시각적으로 표현되는 요소만 포함합니다.
 
5. 렌더링: 렌더링 트리를 기반으로 브라우저는 화면에 실제로 픽셀을 그리고 색상과 텍스처를 적용하여 최종적인 렌더링을 수행합니다. 이 과정을 렌더링이라고 합니다.
5-1. Painting (페인팅):
Painting은 화면에 픽셀을 그리는 프로세스를 가리킵니다.
브라우저가 렌더링 트리와 스타일 정보를 기반으로 화면에 실제 그림을 그리고 색상과 텍스처를 적용하는 과정입니다.
이 단계에서는 브라우저가 화면에 표시할 요소들의 위치, 크기, 색상 등을 고려하여 실제 픽셀로 변환합니다.
Painting은 레이아웃(리플로우)이 발생한 후에 이루어집니다.
5-2. Display (디스플레이):
Display는 화면에 렌더링된 콘텐츠를 실제로 사용자에게 표시하는 과정을 나타냅니다.
이 단계에서는 그려진 픽셀들이 모니터나 디스플레이에 실제로 출력되어 사용자가 볼 수 있습니다.
Display는 브라우저가 그려진 화면을 사용자에게 보여주는 단계입니다.
이러한 단계는 사용자가 페이지를 요청하고 브라우저가 페이지를 표시할 때마다 반복됩니다. 페이지의 내용이 변경되면 브라우저는 다시 렌더링 과정을 실행하여 변경 사항을 반영합니다.

Repaint: 변경된 요소의 스타일이나 내용이 변경되면 브라우저는 해당 요소를 다시 그려야 합니다. 이를 repaint라고도 하며, 변경된 요소와 관련된 부분만을 다시 그리게 됩니다.
이 과정에서는 변경된 부분만을 업데이트하는 것이 아니라, 전체적인 렌더링 과정을 거쳐 다시 그리게 됩니다. 
이러한 점에서 실제 DOM은 변경 사항을 부분적으로 업데이트하기보다는 전체적으로 다시 그리는 것이 일반적입니다.
반면에 가상 DOM은 변경 사항을 가상 DOM에서 먼저 처리하고, 
이후에 실제 DOM과 비교하여 변경된 부분만을 업데이트합니다. 이를 통해 전체적인 렌더링 과정을 최적화하고, 성능을 향상시킬 수 있습니다.
-->

    <!-- 화면에 영향을 미치는 값이 변경되거나 위치, 크기가 변경되면 렌더링엔진의 reflow절차에 의해 -->
    <div id="app">
      <input type="text" class="d" value="이곳을클릭하세요" />
    </div>

    <script>
      // DOMContentLoaded 는 load 와 달리 돔트리가 완성되면 바로 실행
      document.addEventListener('DOMContentLoaded', function () {
        // var app = document.getElementById('app');
        var div = document.querySelector('#app>div');
        var d = app.querySelector('.d');
        d.addEventListener('click', () => {
          d.value = 'a'; //실제DOM 변경 (이곳을클릭하세요 -> a)
        });
        //app.insertBefore(div, d);
        d.addEventListener('focus', () => {
          d.value = 'a'; //실제DOM 변경 ( a -> a)
        });
        // value 는 a로 그대로인데도 click 하면서 focus 될때마다 리플로우와 리페인트가
        //두번씩 비효율적으로 실행된다.
      });
    </script>
  </body>
</html>
